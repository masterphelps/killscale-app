// Type-specific data interfaces for timeline items

export interface VideoItemData {
  thumbnailUrl?: string;
  thumbnails?: string[]; // Array of thumbnail URLs from MediaBunny
  thumbnailTimestamps?: number[]; // Corresponding timestamps for each thumbnail
  duration?: number;
  fps?: number;
  resolution?: string;
  codec?: string;
  originalUrl?: string;
  src?: string; // Video source URL or File
  width?: number;
  height?: number;
  // Content timing properties - define which part of the source video this clip represents
  startFromVideo?: number; // Start time in the source video (in seconds)
  endFromVideo?: number; // End time in the source video (in seconds), if undefined uses startFromVideo + clip duration
}

export interface AudioItemData {
  waveformData?: {
    peaks: number[];
    length: number;
  }
  src?: string; // Audio source URL or File
  startFromSound?: number; // Start time in the source audio (in seconds)
  endFromSound?: number; // End time in the source audio (in seconds)
  duration?: number;
  isLoadingWaveform?: boolean;
  waveformError?: string;
}

export interface TextItemData {
  text?: string;
  fontSize?: number;
  fontFamily?: string;
  fontWeight?: 'normal' | 'bold';
  fontStyle?: 'normal' | 'italic';
  color?: string;
  alignment?: 'left' | 'center' | 'right';
  hasOutline?: boolean;
  hasShadow?: boolean;
  outlineColor?: string;
  shadowColor?: string;
  backgroundColor?: string;
  opacity?: number;
}

export interface CaptionItemData {
  text?: string;
  language?: string;
  speaker?: string;
  confidence?: number; // For auto-generated captions
  isAutoGenerated?: boolean;
  wordTimings?: Array<{
    word: string;
    start: number;
    end: number;
    confidence?: number;
  }>;
  style?: {
    fontSize?: number;
    fontFamily?: string;
    color?: string;
    backgroundColor?: string;
    position?: 'top' | 'bottom' | 'center';
  };
}

export interface ImageItemData {
  thumbnailUrl?: string;
  originalUrl?: string;
  width?: number;
  height?: number;
  format?: string;
  size?: number; // File size in bytes
  hasTransparency?: boolean;
  colorSpace?: string;
  dpi?: number;
  compressionQuality?: number;
}

export interface StickerItemData {
  stickerUrl?: string;
  previewUrl?: string;
  isAnimated?: boolean;
  category?: string;
  tags?: string[];
  frameCount?: number;
  duration?: number; // For animated stickers
  format?: 'gif' | 'lottie' | 'png' | 'svg';
  size?: number;
  backgroundColor?: string;
  hasTransparency?: boolean;
}

export interface BlurItemData {
  blurLevel?: number; // Blur intensity in pixels
  backgroundColor?: string; // Background color for the blur overlay
  borderRadius?: string;
}

// Union type for all item data types
export type TimelineItemData = 
  | VideoItemData
  | AudioItemData
  | TextItemData
  | CaptionItemData
  | ImageItemData
  | StickerItemData
  | BlurItemData
  | Record<string, any>; // Allow custom data structures

// Type guard functions to check item data types
export const isVideoItemData = (data: any): data is VideoItemData => {
  return data && (data.thumbnailUrl !== undefined || data.fps !== undefined || data.codec !== undefined);
};

export const isAudioItemData = (data: any): data is AudioItemData => {
  return data && (data.waveformData !== undefined || data.isLoadingWaveform !== undefined || data.volume !== undefined || data.channels !== undefined);
};

export const isTextItemData = (data: any): data is TextItemData => {
  return data && (data.text !== undefined || data.fontSize !== undefined || data.fontFamily !== undefined);
};

export const isCaptionItemData = (data: any): data is CaptionItemData => {
  return data && (data.wordTimings !== undefined || data.language !== undefined || data.speaker !== undefined);
};

export const isImageItemData = (data: any): data is ImageItemData => {
  return data && (data.width !== undefined || data.height !== undefined || data.format !== undefined);
};

export const isStickerItemData = (data: any): data is StickerItemData => {
  return data && (data.stickerUrl !== undefined || data.isAnimated !== undefined || data.tags !== undefined);
}; 